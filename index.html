<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Star Catcher: Glitch</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; touch-action: none; user-select: none; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #020617; font-family: 'Orbitron', sans-serif; }
        
        #bg-space {
            position: fixed; inset: 0;
            background: radial-gradient(circle at center, #1e293b 0%, #020617 100%);
            z-index: -1;
        }

        #ui { position: absolute; top: 20px; left: 20px; color: white; z-index: 10; pointer-events: none; }
        #ui span { color: #38bdf8; font-size: 1.4rem; }

        #pause-trigger {
            position: absolute; top: 20px; right: 20px;
            width: 50px; height: 50px; border-radius: 50%;
            background: rgba(255,255,255,0.1); border: 2px solid #38bdf8;
            color: #38bdf8; cursor: pointer; z-index: 110;
            display: flex; align-items: center; justify-content: center;
        }

        #menu, #pause-overlay {
            position: fixed; inset: 0; background: rgba(2, 6, 23, 0.95);
            backdrop-filter: blur(20px); display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 100;
            transition: opacity 1s ease;
        }
        #pause-overlay { display: none; }

        .btn {
            width: 300px; padding: 20px; margin: 15px;
            background: transparent; border: 2px solid #38bdf8;
            color: #38bdf8; font-family: 'Orbitron'; font-size: 1.1rem;
            cursor: pointer; border-radius: 15px;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .btn:hover {
            transform: scale(1.3);
            background: #38bdf8; color: #020617;
            box-shadow: 0 0 50px rgba(56, 189, 248, 0.5);
        }

        canvas { display: block; }
    </style>
</head>
<body>
    <div id="bg-space"></div>
    <div id="ui">MODE: <span id="mText">-</span><br>SCORE: <span id="sVal">0</span></div>
    
    <button id="pause-trigger" onclick="togglePause()">II</button>

    <div id="menu">
        <h1 id="menu-title" style="color:white; margin-bottom:40px; text-shadow: 0 0 20px #38bdf8;">ORBIT CATCH</h1>
        <button class="btn" onclick="start('intensity')">INTENSITY (GLITCHY)</button>
        <button class="btn" onclick="start('chaos')">CHAOS (BOUNCY)</button>
        <button class="btn" onclick="start('fast')">SNIPER (TINY)</button>
    </div>

    <div id="pause-overlay">
        <h1 style="color:white;">PAUSED</h1>
        <button class="btn" onclick="togglePause()">RESUME</button>
        <button class="btn" onclick="location.reload()">QUIT</button>
    </div>

    <canvas id="gameCanvas"></canvas>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    
    let score = 0, gameActive = false, isPaused = false, items = [], mode = '';
    let globalShake = 0, fadeAlpha = 1, deathY = 0, deathV = 0;
    let isDying = false;

    const COLORS = ['#FF0055', '#00FFCC', '#38BDF8', '#FBBF24', '#A855F7', '#FF7E00'];
    let bucket = { x: 0, y: 0, w: 125, h: 20, color: '#FFFFFF' };

    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        bucket.y = canvas.height - 100;
    }
    window.addEventListener('resize', resize);
    resize();

    class Ball {
        constructor() {
            this.size = (mode === 'fast') ? 14 : 26;
            this.x = Math.random() * (canvas.width - this.size);
            this.y = -60;
            this.vY = (mode === 'fast') ? 10 : 4;
            this.vX = (mode === 'chaos') ? (Math.random() > 0.5 ? 4 : -4) : 0;
            this.g = 0.22;
            this.color = COLORS[Math.floor(Math.random() * COLORS.length)];
            this.glitchTimer = 0;
        }

        update() {
            if (isPaused || isDying) return 'live';

            if (mode === 'intensity') {
                this.glitchTimer++;
                if (this.glitchTimer % 50 === 0 && Math.random() > 0.4) {
                    this.vX = (Math.random() - 0.5) * 15;
                }
                this.vX *= 0.95;
                this.vY += (score / 2000);
            }

            this.vY += this.g;
            this.y += this.vY;
            this.x += this.vX;

            if (mode === 'chaos' && (this.x <= 0 || this.x >= canvas.width - this.size)) {
                this.vX *= -1.05;
            }

            if (this.x < 0) this.x = 0;
            if (this.x > canvas.width - this.size) this.x = canvas.width - this.size;

            if (this.y + this.size > bucket.y && this.y < bucket.y + bucket.h &&
                this.x + this.size > bucket.x && this.x < bucket.x + bucket.w) {
                return 'hit';
            }
            return this.y > canvas.height ? 'out' : 'live';
        }

        draw() {
            ctx.shadowBlur = 20; ctx.shadowColor = this.color;
            ctx.fillStyle = this.color;
            ctx.beginPath();
            ctx.arc(this.x + this.size/2, this.y + this.size/2, this.size/2, 0, Math.PI*2);
            ctx.fill();
        }
    }

    function togglePause() {
        if (!gameActive || isDying) return;
        isPaused = !isPaused;
        document.getElementById('pause-overlay').style.display = isPaused ? 'flex' : 'none';
    }

    function start(m) {
        mode = m;
        document.getElementById('mText').innerText = m.toUpperCase();
        document.getElementById('menu-title').innerText = "ORBIT CATCH";
        score = 0; items = []; gameActive = true; isPaused = false; isDying = false;
        fadeAlpha = 1; deathY = 0; deathV = 0;
        document.getElementById('menu').style.opacity = 0;
        setTimeout(() => document.getElementById('menu').style.display = 'none', 500);
        loop();
    }

    function triggerDeath() {
        isDying = true;
        deathV = 2; // Initial slow fall
    }

    function loop() {
        if (!gameActive) return;
        
        ctx.save();
        
        // Handle Death Animation
        if (isDying) {
            deathV += 0.5; // Accelerate
            deathY += deathV;
            fadeAlpha -= 0.02; // Fade away
            if (fadeAlpha <= 0) {
                gameActive = false;
                document.getElementById('menu').style.display = 'flex';
                document.getElementById('menu').style.opacity = 1;
                document.getElementById('menu-title').innerText = "FINAL SCORE: " + score;
                return;
            }
            ctx.translate(0, deathY);
            ctx.globalAlpha = fadeAlpha;
        }

        if (!isPaused) {
            if (globalShake > 0) {
                ctx.translate(Math.random() * globalShake - globalShake/2, Math.random() * globalShake - globalShake/2);
                globalShake *= 0.85;
            }
            
            ctx.clearRect(-100, -500, canvas.width+200, canvas.height+1000);

            ctx.fillStyle = bucket.color;
            ctx.shadowBlur = 15; ctx.shadowColor = "white";
            ctx.fillRect(bucket.x, bucket.y, bucket.w, bucket.h);

            if (items.length === 0 && !isDying) {
                items.push(new Ball());
            }

            for (let i = items.length - 1; i >= 0; i--) {
                const status = items[i].update();
                items[i].draw();

                if (status === 'hit') {
                    score += (mode === 'fast') ? 50 : 10;
                    globalShake = 15;
                    document.getElementById('sVal').innerText = score;
                    items.splice(i, 1);
                } else if (status === 'out') {
                    triggerDeath();
                }
            }
        }
        ctx.restore();
        requestAnimationFrame(loop);
    }

    const move = (e) => {
        if (isPaused || isDying) return;
        const x = e.touches ? e.touches[0].clientX : e.clientX;
        bucket.x = x - bucket.w / 2;
    };
    window.addEventListener('mousemove', move);
    window.addEventListener('touchmove', move);
</script>
</body>
</html>